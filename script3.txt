USE AdventureWorks2014
GO
SELECT P.BUSINESSENTITYID,P.FIRSTNAME,P.LASTNAME,
E.JOBTITLE,E.BIRTHDATE,E.GENDER,S.TERRITORYID,
S.SALESQUOTA,COUNT(SOH.SALESPERSONID) AS NUM_VENTAS,
SUM(SOD.LINETOTAL) AS GANANCIA
FROM PERSON.PERSON AS P INNER JOIN HUMANRESOURCES.EMPLOYEE AS E
ON P.BusinessEntityID=E.BusinessEntityID
INNER JOIN SALES.SALESPERSON AS S ON
S.BusinessEntityID=E.BusinessEntityID
INNER JOIN SALES.SALESORDERHEADER AS SOH
ON SOH.SalesPersonID=S.BusinessEntityID INNER JOIN
SALES.SalesOrderDetail AS SOD ON
SOH.SalesOrderID=SOD.SalesOrderID
WHERE YEAR(GETDATE())-YEAR(E.BIRTHDATE)<=40
GROUP BY P.BUSINESSENTITYID,P.FIRSTNAME,P.LASTNAME,
E.JOBTITLE,E.BIRTHDATE,E.GENDER,S.TERRITORYID,
S.SALESQUOTA
HAVING SUM(SOD.LINETOTAL)>=7000000
ORDER BY NUM_VENTAS DESC
 GO

SELECT SOD.SALESORDERID,SOD.PRODUCTID,SOD.UNITPRICE,
SOD.ORDERQTY
FROM SALES.SalesOrderHeader AS SOH INNER JOIN 
SALES.SalesOrderDetail AS SOD
ON SOH.SalesOrderID=SOD.SalesOrderID
WHERE SOH.SalesOrderID=43659
GO

SELECT SALESORDERID,PRODUCTID,UNITPRICE FROM
SALES.SALESORDERDETAIL WHERE SALESORDERID IN
(SELECT SALESORDERID FROM SALES.SalesOrderHeader
WHERE SalesOrderID=43659)

SELECT COUNT(CustomerID) AS TOTAL FROM SALES.Customer
GO

SELECT DISTINCT C.CUSTOMERID,C.PERSONID FROM
SALES.Customer AS C LEFT JOIN
SALES.SalesOrderHeader AS SOH
ON SOH.CustomerID=C.CustomerID
WHERE SOH.CUSTOMERID IS NULL
ORDER BY C.CUSTOMERID

GO